# Humetix 프로젝트 기술부채 진단 보고서

**작성일:** 2025년 2월 15일  
**대상:** Humetix_Project (Flask 기반 채용/지원서 관리 웹 애플리케이션)

---

## 1. 요약

본 프로젝트는 Flask로 구현된 입사지원서 접수·관리 시스템입니다. JSON 파일 기반 데이터 저장, 관리자 페이지, 엑셀 내보내기 등 핵심 기능은 동작하나, **보안**, **코드 품질**, **아키텍처**, **테스트·운영** 측면에서 개선이 필요한 기술부채가 다수 존재합니다.

---

## 2. 보안 관련 기술부채

### 2.1 민감 정보 하드코딩 (심각)

| 항목 | 현재 상태 | 위험도 |
|------|-----------|--------|
| `app.secret_key` | `'humetix_secure_key'` 고정 | **높음** |
| `ADMIN_PASSWORD` | `"3326"` 소스 코드에 직접 기재 | **매우 높음** |

- **문제:** 비밀번호·시크릿 키가 코드/저장소에 노출되면 세션 위조·관리자 계정 탈취 가능.
- **권장:** 환경 변수(`os.environ`) 또는 `.env`(python-dotenv)로 분리하고, 배포 시 값만 설정. `.env`는 `.gitignore`에 포함.

### 2.2 인증·권한 부족

- **관리자 인증:** 단일 비밀번호만 사용. 다중 관리자·역할·로그인 시도 제한 없음.
- **권장:** 필요 시 사용자 테이블·역할(RBAC)·실패 횟수 제한·계정 잠금 등 도입 검토.

### 2.3 파일 업로드·경로 보안

- **업로드:** 확장자만 시간 기반으로 붙이고, **파일 타입(매직 바이트)·크기 제한** 없음. 악성 파일 업로드 가능.
- **`/view_photo/<filename>`:** `filename`에 대한 **경로 탐색(path traversal)** 검증 없음. `../` 등으로 다른 디렉터리 접근 가능성.
- **권장:**
  - `werkzeug.secure_filename` 또는 화이트리스트 확장자 검사.
  - 이미지인 경우 Pillow 등으로 실제 포맷 검증.
  - 최대 파일 크기 제한(Flask `MAX_CONTENT_LENGTH` 등).
  - `view_photo`에서 `filename`에 `..` 또는 절대경로 포함 시 400/404 반환.

### 2.4 XSS(Cross-Site Scripting) 위험

- **`master_view`:** 지원자 데이터(`entry['info']['name']` 등)를 HTML 문자열에 **이스케이프 없이** `f'''...{entry[...]}...'''` 형태로 삽입.
- **문제:** 이름·주소 등에 `<script>`, `onerror=` 등이 들어가면 스크립트 실행 가능.
- **권장:** 템플릿 엔진(Jinja2) 사용 시 `{{ value }}` 자동 이스케이프 활용. 문자열 조합을 유지할 경우 `markupsafe.escape()` 또는 Flask의 이스케이프 유틸 적용.

### 2.5 기타 보안

- **HTTPS:** Nginx 주석으로 SSL 언급되어 있으나, 앱 단에서 HTTPS 강제·HSTS 등은 미적용(프록시 설정에 맡긴 상태로 가정).
- **CSRF:** 폼에 CSRF 토큰 없음. Flask-WTF 등으로 POST 폼에 CSRF 보호 적용 권장.
- **세션:** 서버 재시작 시 메모리 세션 초기화. 필요 시 세션 스토어(Redis 등) 검토.

---

## 3. 코드 품질·유지보수성

### 3.1 예외 처리

- **Bare `except:`** (예: `load_data()` 33행): 모든 예외를 잡아 구체적 오류 원인 파악이 어렵고, `KeyboardInterrupt` 등까지 삼킴.
- **`except: pass`** (388행): 오류를 무시해 디버깅이 어려움.
- **권장:** `except Exception as e:` 사용 시 최소한 로깅. JSON/파일 관련은 `json.JSONDecodeError`, `IOError` 등 구체적 예외 처리. 재발생이 필요하면 `raise`.

### 3.2 단일 파일·역할 혼재

- **현재:** 라우트·비즈니스 로직·데이터 접근·HTML 생성이 `app.py` 한 파일에 혼재(약 390행).
- **문제:** 테스트·재사용·기능 추가 시 변경 영향 범위가 크고, 가독성 저하.
- **권장:**  
  - 라우트(`routes/`), 서비스(비즈니스 로직), 저장소(JSON 로드/세이브) 분리.  
  - 관리자 목록 HTML은 Jinja2 템플릿(`templates/`)으로 이전하고, 데이터만 넘기기.

### 3.3 데이터 접근 방식

- **JSON 파일 직접 읽기/쓰기:** 동시 접속 시 경쟁 조건·파일 손상 가능성.
- **권장:** 소규모라도 파일 잠금(예: `fcntl`, `filelock`) 또는 단순 DB(SQLite) 도입 검토. 트랜잭션·동시성 제어에 유리.

### 3.4 매직 넘버·문자열

- 관리자 URL 경로(`/humetix_master_99`, `/humetix_master_99` 등), 메시지 문자열이 코드 곳곳에 하드코딩.
- **권장:** 상수·설정 모듈(`config.py`)로 모아서 관리.

### 3.5 데드 코드

- **386–387행:** `return redirect(...)` 이후에 `app.run(...)` 주석 코드가 있음. 실행되지 않으나 혼란 유발.
- **권장:** 사용하지 않으면 삭제. 실행 진입점은 `if __name__ == '__main__':` 블록으로 분리하는 것이 일반적.

### 3.6 데이터 구조 중복

- `submit()`에서 `body`와 `work_condition`에 나뉘어 저장되는 필드가 있고, `work_condition`에 `interview_date`, `start_date`, `agree` 등이 섞여 있음. 스키마가 한눈에 들어오지 않음.
- **권장:** 스키마를 문서화(주석 또는 JSON Schema)하고, 필요 시 키 이름·계층 구조 정리.

---

## 4. 아키텍처·설계

### 4.1 뷰에서 HTML 문자열 직접 생성

- **`master_view`:** 140행 근처부터 긴 HTML 문자열을 Python에서 `+=`로 조합. 수정·디자인 변경 시 실수하기 쉽고, XSS 대응도 어려움.
- **권장:** `templates/admin/list.html` 등 Jinja2 템플릿으로 이전하고, 리스트만 뷰에서 전달. 자동 이스케이프로 XSS 완화.

### 4.2 설정 분산

- 호스트/포트, 디버그 모드, 업로드 경로, 데이터 파일 경로 등이 코드 여기저기 흩어져 있음.
- **권장:** `config.py` 또는 환경 변수 기반 설정 한 곳에서 관리(개발/스테이징/운영 구분 가능).

### 4.3 파일 저장 위치

- **엑셀 다운로드:** `applicants_export.xlsx`를 현재 작업 디렉터리에 저장 후 `send_file`. 다중 요청 시 덮어쓰기·경쟁 가능성. 배포 경로에 따라 쓰기 권한 이슈 가능.
- **권장:** 임시 디렉터리(`tempfile.gettempdir()` 또는 프로젝트 내 `tmp/`)에 고유 파일명으로 저장하고, 전송 후 삭제(또는 주기 정리).

---

## 5. 테스트·문서·운영

### 5.1 테스트 부재

- 단위 테스트·통합 테스트·테스트 디렉터리 없음. 리팩터링·배포 시 회귀 위험.
- **권장:** `pytest` + `pytest-flask` 등으로  
  - `load_data`/`save_data` 동작,  
  - `/submit` 검증(필수 필드, 파일 업로드),  
  - `/login` 성공/실패,  
  - 관리자 전용 라우트 비인증 시 리다이렉트  
  등을 우선 작성.

### 5.2 의존성 관리

- **requirements.txt:** 버전이 고정되어 있어 유지보수에는 유리. 보안 패치 반영을 위해 주기적 `pip list --outdated` 확인 권장.
- **가상환경:** 문서에 `venv`/`virtualenv` 사용 안내가 있으면 좋음.

### 5.3 로깅·모니터링

- 로깅 설정 없음. 예외·중요 동작(지원서 접수, 로그인 실패 등) 기록이 없어 장애 추적이 어렵움.
- **권장:** `logging` 모듈 설정(파일/콘솔, 레벨). 에러는 반드시 로그에 남기기.

### 5.4 문서

- README·API·설치·환경 변수·배포 방법에 대한 문서가 없음. 신규 참여자·배포 시 어려움.
- **권장:** 최소한 README에 프로젝트 소개, 설치 절차, 환경 변수 목록, 로컬 실행 방법을 기재.

---

## 6. 개선 우선순위 제안

| 우선순위 | 항목 | 예상 공수 | 비고 |
|----------|------|-----------|------|
| P0 | 비밀번호·시크릿 키 환경 변수 분리 | 소 | 즉시 적용 권장 |
| P0 | `view_photo` 경로 탐색 방지 + 업로드 파일 검증(확장자/크기) | 소 | 보안 사고 예방 |
| P1 | 관리자 페이지 HTML을 Jinja2로 이전 + 출력 이스케이프(XSS 방지) | 중 | 보안·유지보수 동시 개선 |
| P1 | Bare `except` 제거 및 예외 로깅 도입 | 소 | 안정성·디버깅 |
| P2 | 설정(config) 및 상수 분리 | 소 | 확장성 |
| P2 | 라우트/서비스/저장소 계층 분리 | 중 | 테스트·유지보수 |
| P2 | pytest 기반 핵심 플로우 테스트 | 중 | 회귀 방지 |
| P3 | CSRF 보호(Flask-WTF 등) | 소 | 보안 강화 |
| P3 | 로깅 표준화 | 소 | 운영·장애 대응 |
| P3 | README 및 환경 변수 문서화 | 소 | 온보딩·배포 |

---

## 7. 결론

- **강점:** Flask 사용, Bootstrap 기반 UI, 입사지원·관리·엑셀 내보내기 등 요구 기능은 구현되어 있음.
- **핵심 리스크:** 보안(비밀번호/시크릿 하드코딩, 경로 탐색, XSS), 예외 처리·코드 구조로 인한 유지보수성·안정성 저하.
- **권장 방향:** 위 표의 P0·P1을 우선 적용한 뒤, 단계적으로 설정 분리·계층 분리·테스트·문서화를 진행하는 것이 좋습니다.

---

*본 보고서는 현재 코드베이스 기준으로 작성되었으며, 추후 변경 시 재검토가 필요합니다.*
