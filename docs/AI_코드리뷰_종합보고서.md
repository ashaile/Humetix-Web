# Humetix 인력관리 시스템 — AI 코드리뷰 종합 보고서

> **작성일**: 2026-02-24
> **분석 대상**: GitHub `ashaile/Humetix-Web` 리포지토리
> **리뷰어**: Claude Opus 4.6 / GPT 5.2 / Gemini
> **시스템 개요**: Flask 기반 아웃소싱 인력관리 시스템 (직원 100~200명 규모)

---

## 1. 리뷰 개요

세 AI 모두 동일한 GitHub 코드베이스를 분석했으며, 각자 다른 관점에서 피드백을 제공했다.

| 구분 | Claude Opus 4.6 | GPT 5.2 | Gemini |
|------|-----------------|---------|--------|
| **분석 관점** | 코드 품질 + 보안 취약점 | 운영 리스크 + 데이터 정합성 | 법률 준수 + 엔터프라이즈 전략 |
| **분량** | 11개 항목 체크리스트 | 18개 항목 (P0~P2) | 7페이지 전략 보고서 |
| **특징** | 즉시 고칠 수 있는 코드 레벨 지적 | 실무 운영자 시점의 리스크 분석 | 근로기준법/개인정보보호법 기반 법적 가이드 |

### 잘 된 점 (세 AI 공통 긍정 평가)

- 모델/서비스/라우트 분리 구조가 깔끔함 (Blueprint 패턴)
- CSRF 보호, bcrypt 해시, 보안 헤더 등 보안 기본기가 갖춰져 있음
- 로그인 브루트포스 방어 (IP 기반 시도 횟수 제한) 구현됨
- 급여 계산 시 `is_manual` 플래그로 수동 수정 건을 보호하는 로직이 세심함
- 4대보험/3.3% 소득세 분기 처리가 한국 실무에 맞게 구현됨
- 환경별 설정 분리 (`DevelopmentConfig` / `ProductionConfig`)가 적절함

---

## 2. 세 AI 공통 지적 사항

> 세 AI가 모두 동일하게 지적한 항목은 **반드시 해결해야 할 핵심 문제**로 볼 수 있다.

### 2-1. 직원 셀프서비스 인증이 너무 약함

**현재 상태**: 급여명세서 조회, 가불 신청 등이 `이름 + 생년월일(6자리)`만으로 인증된다.

**왜 문제인가**:
- 생년월일은 동료끼리 쉽게 알 수 있어 사실상 인증이 없는 것과 같다
- `/payslip/pdf?birth_date=950101&emp_name=홍길동` 같은 URL이 브라우저 히스토리, 서버 로그에 그대로 남는다
- 급여 정보는 개인정보보호법상 민감 정보에 해당한다
- `/api/employees/verify` API를 통해 전 직원 이름/생년월일 조합을 무차별 대입할 수 있다

**해결 방향**:
- (최소) 직원 등록 시 PIN 번호 설정 → 이름 + 생년월일 + PIN 3중 확인
- (권장) 사번(employee_code) + OTP(문자 인증) 기반 로그인 체계 도입
- PDF 다운로드를 GET → POST로 변경하여 URL에 개인정보 노출 방지
- 일정 횟수 이상 인증 실패 시 차단

### 2-2. 감사 로그(Audit Trail) 없음

**현재 상태**: 관리자가 급여 수정, 가불 승인/반려, 직원 정보 변경을 해도 **누가 언제 무엇을 했는지** 기록이 남지 않는다.

**왜 문제인가**:
- 급여 관련 분쟁 발생 시 원인 추적이 불가능하다
- `is_manual`로 수동 수정된 급여의 변경 이력을 확인할 방법이 없다
- 근태 엑셀 업로드 후 누가 어떤 데이터를 올렸는지 추적할 수 없다

**해결 방향**:
```
audit_logs 테이블
- actor       : 누가 (admin_user_id / IP)
- action      : 뭘 했는지 (create / update / delete / approve / reject)
- target      : 대상 (테이블명, 레코드 ID)
- before/after: 변경 전/후 값 (JSON)
- timestamp   : 언제
```

**최소한 기록해야 할 이벤트**:
- 근태 생성/수정/삭제, 엑셀 업로드
- 가불 승인/반려 및 금액 변경
- 급여 생성/삭제/수동수정/재계산
- 직원 정보 변경

### 2-3. 단일 관리자 계정 구조

**현재 상태**: `.env`에 저장된 하나의 비밀번호로 모든 관리자가 같은 계정을 공유한다.

**왜 문제인가**:
- 실제 운영에서는 대표, 인사담당, 현장소장이 각각 다른 권한이 필요하다
- 누가 로그인했는지 구분할 수 없어 감사 로그도 의미가 없어진다
- 비밀번호 변경 로직이 환경변수 평문 비교와 섞여 있어 운영 혼선 가능

**해결 방향**:
```
Admin 테이블
- username
- hashed_password (bcrypt)
- role: superadmin / hr / site_manager
- is_active
- last_login
```

역할별 권한 예시:
- `superadmin`: 전체 기능 접근
- `hr`: 인사/급여/가불 관리
- `site_manager`: 해당 현장의 근태/직원만 조회

### 2-4. 공휴일/보험요율이 코드에 고정됨

**현재 상태**: `config.py`에 `PUBLIC_HOLIDAYS_2026`이 하드코딩되어 있다. 4대보험 요율도 코드에 직접 입력되어 있다.

**왜 문제인가**:
- 2027년이 되면 수동으로 코드를 수정해야 한다
- 국민연금 상/하한액은 매년 7월에 변경되는데, 이를 놓치면 정산이 틀린다
- 코드 수정 → 배포가 필요하므로 관리자가 직접 업데이트할 수 없다

**해결 방향**:
- 공휴일/보험요율을 DB 테이블로 관리
- 관리자 페이지에서 직접 등록/수정 가능하게
- (선택) 한국 공공데이터포털 공휴일 API 연동

### 2-5. 현장 배치가 단일 site_id (이력 관리 불가)

**현재 상태**: Employee 모델에 `site_id` 하나만 있어 **현재 배치**만 표현된다.

**왜 문제인가**:
- 한 직원이 이전에 어느 현장에 있었는지 이력이 남지 않는다
- 현장별로 시급/수당이 다른데, 배치 변경 시 이전 조건이 사라진다
- 아웃소싱 핵심인 "누가 어디에 언제부터 언제까지 투입됐는지" 추적 불가

**해결 방향**:
```
employee_assignments 테이블
- employee_id
- site_id
- start_date / end_date
- role
- pay_rate (시급/일급)
- memo
```

### 2-6. SQLite 동시성 한계

**현재 상태**: SQLite 파일 기반 DB + Gunicorn 워커 3개로 운영 중이다.

**왜 문제인가**:
- 100~200명이 동시에 출근 체크하거나 급여를 확인하면 DB 잠금(Locking) 발생
- 쓰기 작업이 몰리는 시점(근태 입력, 가불 신청)에 간헐적 에러 가능
- 백업 메커니즘이 없어 서버 장애 시 데이터 유실 위험

**해결 방향**:
- MySQL 전환을 기능 추가보다 우선순위 높게 진행
- 전환 전까지 WAL 모드 적용 + 워커 수 보수적 운영
- 일일 자동 백업 설정

---

## 3. Claude만 지적한 사항

> Claude는 **즉시 수정 가능한 코드 레벨 문제**를 구체적으로 짚어냈다.

### 3-1. bcrypt가 requirements.txt에 누락

`routes/auth.py`에서 `import bcrypt`를 사용하지만, `requirements.txt`에 포함되어 있지 않다. 새 환경에 배포하면 앱 자체가 시작되지 않는다.

```
# requirements.txt에 추가 필요
bcrypt>=4.0.0
```

**난이도**: 하 (1분 소요)

### 3-2. node_modules/가 Git에 커밋됨

`.gitignore`에 `node_modules/`가 있지만, 이미 커밋된 상태라 7.9MB의 불필요한 파일이 저장소에 포함되어 있다. `openai` 패키지까지 들어 있어 보안 감사 시 의문을 살 수 있다.

```bash
git rm -r --cached node_modules/
git commit -m "Remove tracked node_modules"
```

**난이도**: 하 (2분 소요)

### 3-3. API Rate Limiting 부재

공개 엔드포인트(`/apply`, `/advance`, `/payslip`, `/api/employees/verify`)에 속도 제한이 없다.

**위험 시나리오**:
- `/api/employees/verify`로 전 직원 이름/생년월일 조합 무차별 대입
- 입사지원서 스팸 대량 접수
- 가불 신청 폭탄

**해결**: `Flask-Limiter` 도입 (공개 API에 분당 5~10회 제한)

**난이도**: 하 (30분 소요)

### 3-4. N+1 쿼리 성능 문제

`Site.to_dict()`에서 `employee_count`를 `len([e for e in self.employees if e.is_active])`로 계산한다. 현장 목록 조회 시 각 현장마다 전체 직원을 메모리에 로드하는 비효율이 있다.

**해결**: `db.session.query(func.count(...))` 서브쿼리로 변경

**난이도**: 하

### 3-5. 기타 코드 품질

- `datetime.now` vs `datetime.utcnow` 혼재 (한국 전용이면 현재 방식도 실용적)
- 에러 메시지 한국어/영어 혼재 (`"JSON body required"` 등)
- 근태 일괄 가져오기에서 6,000건 개별 INSERT → `bulk_save_objects()` 권장

---

## 4. GPT만 지적한 사항

> GPT는 **실무 운영자 시점**에서 데이터 정합성과 구조적 리스크를 깊게 분석했다.

### 4-1. 급여 마감(Closing/Lock) 개념 없음

**현재 상태**: 급여를 생성한 뒤에도 해당 월의 근태 데이터를 자유롭게 수정/삭제할 수 있다. 급여와 근태 사이의 정합성이 보장되지 않는다.

**왜 문제인가**:
- 1월 급여를 확정한 후 누군가 1월 근태를 수정하면, 이미 지급된 급여와 맞지 않게 된다
- "급여 생성 → 검증 → 확정(잠금)" 단계가 없어 실수로 재계산하면 기존 값이 덮어씌워진다

**해결 방향**:
```
payruns 테이블 (월별 정산 단위)
- month
- status: draft → approved → locked
- locked_at / locked_by
```
- locked 상태에서는 해당 월 근태 수정/삭제 제한
- 급여 수동수정 시 사유/로그 강제

### 4-2. 엑셀 근태 업로드의 자동 직원 생성 리스크

**현재 상태**: 엑셀에 없는 직원이 포함되어 있으면 `birth_date="000000"`으로 자동 생성한다.

**왜 문제인가**:
- 동명이인 구분이 불가능하다
- `000000` 생년월일로 직원 인증 시스템을 통과할 수 있다
- 불완전한 프로필로 급여 정산에 포함될 수 있다

**해결 방향**:
- 자동 생성 시 "미완성 프로필" 플래그 추가
- 필수값 완료 전까지 셀프서비스/정산에서 제외
- (권장) 스테이징 테이블 → 매칭 확정 → 본 테이블 반영

### 4-3. PII(개인정보) 보관/파기 정책 없음

**현재 상태**: 지원서에 신분증 이미지 업로드가 있지만, 보관 기간/파기 정책/접근 제한이 없다.

**왜 문제인가**:
- 미채용 지원자의 신분증이 서버에 무기한 보관됨
- 파일 경로가 추측 가능한 URL이면 외부 접근 위험
- 개인정보보호법상 목적 달성 후 지체 없이 파기해야 함

**해결 방향**:
- 업로드 파일: 웹루트 밖 저장 + 관리자 인증 없이 접근 불가
- 보관 기간 정책 수립 (예: 미채용자 3개월 후 파기, 퇴사자 3년 보관)
- 자동 파기 배치 작업 설정

### 4-4. 네트워크 보안 하드닝

**현재 상태**: Gunicorn이 `0.0.0.0:5000`으로 바인딩되어 있다.

**왜 문제인가**:
- Nginx 앞단이 있어도 방화벽이 약하면 5000번 포트로 직접 접근이 가능하다

**해결 방향**:
- Gunicorn은 `127.0.0.1:5000` 바인딩 → Nginx만 외부 노출
- Nginx에서 HTTPS 강제 + HSTS 헤더
- 보안 헤더 추가: `Strict-Transport-Security`, `Content-Security-Policy`

### 4-5. 입력 검증/에러 응답 통일

각 라우트마다 입력 검증 방식이 제각각이다. 라우트가 늘수록 유지보수가 어려워진다.

**해결 방향**: Pydantic 또는 Marshmallow로 API 입력 스키마 통일, 공통 에러 포맷 정의

---

## 5. Gemini만 지적한 사항

> Gemini는 **한국 노동법/개인정보보호법** 관점에서 가장 상세한 법률 가이드를 제공했다.

### 5-1. 임금명세서 법적 필수 기재사항 미충족

**법적 근거**: 근로기준법 제48조 제2항 (2021.11.19 시행)

**현재 상태**: 급여명세서에 기본 항목은 있으나, 법이 요구하는 **계산식**이 빠져 있다.

**법이 요구하는 필수 기재 항목**:

| 구분 | 필수 항목 | 현재 충족 여부 |
|------|----------|--------------|
| 기본 정보 | 성명, 생년월일, 사원번호 | O |
| 지급 정보 | 임금지급일, 임금 총액 | O |
| 구성 항목 | 기본급, 각종 수당별 명칭과 금액 | 부분 충족 |
| **계산 방법** | **항목별 계산식 및 근로 시간수** | **X (미충족)** |
| 공제 내역 | 4대보험, 소득세, 지방소득세 | O |

**위반 시**: 근로자 1인당 최대 **500만원 이하 과태료**

**해결 방향**: 급여명세서에 연장/야간/휴일 근로시간수와 가산율 적용 계산식을 명시

### 5-2. 최저임금 위반 검증 로직 없음

**2025년 최저임금**: 시급 10,030원 (전년 대비 1.7% 인상)

- 주 40시간 근무자(월 209시간 기준) → 월 **2,096,270원** 이상 지급 의무
- 주휴수당 계산식: `(1주 소정근로시간 / 40시간) x 8 x 시급`

**현재 상태**: 근태와 연동하여 최저임금 미달 여부를 검증하는 로직이 없다.

**해결 방향**: 급여 생성 시 최저임금 위반 여부 자동 경고

### 5-3. 지각/조퇴의 법적 처리

**법원/고용노동부 행정해석**: 지각이나 조퇴가 있더라도 해당 일에 출근하여 근로를 제공했다면 **'결근'으로 처리할 수 없다**. 주휴수당 산정을 위한 '개근' 요건에 영향을 미치지 않는다.

**주의할 점**: 지각/조퇴 시간을 합산하여 무조건적으로 결근 처리하거나 주휴수당을 미지급하면 **법적 리스크** 발생

**해결 방향**: 실제 근로하지 않은 시간만큼만 시급 단위로 공제하는 방식 적용

### 5-4. 전자근로계약서 도입

**법적 근거**: 근로기준법 제17조, 전자서명법

**왜 필요한가**:
- 아웃소싱 회사는 입퇴사율이 높아 수기 계약이 운영 효율을 크게 저해한다
- 고용노동부가 전자근로계약서의 법적 효력을 공식 인정하고 있다
- 근로계약서는 근로관계 종료 후 **3년간 보존 의무**

**구현 단계**:

| 단계 | 기능 | 관련 법규 |
|------|------|----------|
| 작성 | 표준/맞춤형 양식, 모바일 최적화 | 근로기준법 제17조 |
| 서명 | SMS/카카오톡 인증 기반 전자서명 | 전자서명법 |
| 교부 | 체결 즉시 PDF 자동 전송 | 근로기준법 제17조 제2항 |
| 보관 | 클라우드 기반 3년 보존 자동화 | 근로기준법 제42조 |

**워크플로우**: 지원자 합격 처리 → 계약서 작성 요청 자동 발송 → 전자서명 → PDF 보관

### 5-5. 파견법 관리장부 자동화

**해당되는 경우**: 아웃소싱이 '근로자 파견업' 허가를 받은 경우

**의무사항**:
- 파견근로자 명부: 파견 사유, 기간, 사용사업주 명칭/소재지, 지휘명령자 정보
- 파견 근로자 요구 시 파견 대가(수수료) 내역 서면 제시 의무

**해결 방향**: 시스템에서 해당 데이터를 자동 추출할 수 있는 기능 필요

### 5-6. 개인정보보호법(PIPA) 상세 준수

**개인정보보호법 제24조의2**: 주민등록번호 처리는 원칙적으로 금지. 다만 근로기준법/소득세법에 따른 의무 이행을 위해 수집 가능.

**필수 보안 조치**:

| 구분 | 요구사항 | 위반 시 |
|------|---------|--------|
| 양방향 암호화 | 주민번호, 계좌번호 → AES-256 / SEED / ARIA | 3,000만원 이하 과태료 |
| 일방향 암호화 | 비밀번호 → bcrypt / Argon2 (솔트 포함) | - |
| 전송 암호화 | 모든 전송 HTTPS(TLS) 필수 | - |
| 접근 통제 | RBAC + 접속 기록 최소 1년 보관 | - |
| 최소 수집 | 채용에 불필요한 개인정보 수집 금지 | - |
| 파기 의무 | 미채용자/법적 보존기간 경과 데이터 복구 불가능하게 파기 | - |

### 5-7. 시스템 운영 인프라

**모니터링**: Sentry 연동으로 런타임 에러 실시간 수집 → Slack 알림

**비동기 처리**: 급여 PDF 생성, 대량 SMS 발송 등은 Celery + Redis로 백그라운드 처리 권장

**장기 비전**: GPS/Wi-Fi 기반 위치 인증 출퇴근, 인력 수요 예측/퇴사 위험도 분석

---

## 6. 통합 우선순위 로드맵

### 1단계: 즉시 수정 (1일 이내)

> 코드 수정만으로 해결 가능한 항목

| # | 항목 | 난이도 | 지적한 AI |
|---|------|--------|----------|
| 1 | `bcrypt` → requirements.txt 추가 | 1분 | Claude |
| 2 | `node_modules/` Git 캐시 제거 | 2분 | Claude |
| 3 | Flask-Limiter 도입 (Rate Limiting) | 30분 | Claude |
| 4 | N+1 쿼리 수정 (`Site.to_dict()`) | 15분 | Claude |
| 5 | Gunicorn 바인딩 `127.0.0.1`로 변경 | 5분 | GPT |

### 2단계: 보안 필수 (1~2주)

> 배포 전 반드시 완료해야 할 보안/법률 항목

| # | 항목 | 난이도 | 지적한 AI |
|---|------|--------|----------|
| 6 | 직원 인증 강화 (PIN/OTP) | 중 | 전원 |
| 7 | 감사 로그(Audit Trail) 시스템 | 중 | 전원 |
| 8 | 급여 마감(Lock) 개념 도입 | 중 | GPT |
| 9 | API Rate Limiting 세부 적용 | 하 | Claude |
| 10 | PII 파일 접근 제한 + 파기 정책 | 중 | GPT, Gemini |

### 3단계: 운영 안정화 (1~2개월)

> 시스템 기반 강화

| # | 항목 | 난이도 | 지적한 AI |
|---|------|--------|----------|
| 11 | 다중 관리자 + RBAC 권한 | 상 | 전원 |
| 12 | SQLite → MySQL 전환 | 중 | 전원 |
| 13 | 공휴일/보험요율 DB 관리 + 관리자 UI | 하 | 전원 |
| 14 | 현장 배치 이력 테이블 (`employee_assignments`) | 중 | 전원 |
| 15 | 임금명세서 법적 요건 보완 (계산식 포함) | 중 | Gemini |
| 16 | 최저임금 위반 자동 검증 | 하 | Gemini |

### 4단계: 기능 확장 (3~6개월)

> 경쟁력 강화를 위한 추가 기능

| # | 항목 | 난이도 | 지적한 AI |
|---|------|--------|----------|
| 17 | 전자근로계약서 모듈 | 상 | Gemini |
| 18 | 연차/휴가/퇴직금 관리 | 상 | Claude, GPT |
| 19 | 고객사 청구/정산(매출) 모듈 | 상 | GPT, Gemini |
| 20 | Celery 비동기 처리 (PDF/SMS) | 중 | Gemini |
| 21 | Sentry 에러 모니터링 | 하 | Gemini |
| 22 | 입력 검증 스키마 통일 (Pydantic) | 중 | GPT |

---

## 7. 결론

세 AI의 리뷰를 종합하면, Humetix는 **기본 구조와 핵심 기능이 잘 갖춰져 있으나**, 실제 운영 환경에서 필요한 **보안, 법률 준수, 데이터 정합성** 측면에서 보강이 필요하다.

**가장 시급한 3가지**:
1. **직원 인증 강화** — 현재 이름+생년월일만으로는 개인정보 유출 위험이 크다
2. **감사 로그** — 급여/가불 관련 변경 이력이 없으면 분쟁 시 대응이 불가하다
3. **급여 마감 개념** — 급여 확정 후 근태 수정을 허용하면 정산 정합성이 깨진다

이 세 가지를 해결하면 실무 운영에 필요한 최소한의 안전장치가 확보되며, 이후 RBAC, MySQL 전환, 전자근로계약서 등으로 단계적 확장이 가능하다.
