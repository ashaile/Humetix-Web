{% extends "base_public.html" %}

{% block public_title %}HUMETIX - 연차 조회{% endblock %}

{% block page_css %}
.leave-container {
    max-width: 560px;
    margin: 0 auto;
    padding: 32px 24px;
    padding-top: 80px;
}
.page-title {
    font-size: 26px;
    font-weight: 800;
    letter-spacing: -.5px;
    margin-bottom: 8px;
}
.page-desc {
    color: var(--text2);
    font-size: 14px;
    margin-bottom: 28px;
}
.input-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px;
    margin-bottom: 24px;
}
.input-card h3 {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 20px;
}
.form-group { margin-bottom: 16px; }
.form-label {
    display: block;
    font-size: 12px;
    font-weight: 600;
    color: var(--text2);
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: .5px;
}
.form-input {
    width: 100%;
    padding: 10px 14px;
    border: 1px solid var(--border);
    border-radius: var(--radius-sm);
    font-size: 14px;
    font-family: inherit;
    background: var(--bg);
    color: var(--text);
    transition: border-color .2s;
}
.form-input:focus {
    outline: none;
    border-color: var(--accent);
    box-shadow: 0 0 0 3px rgba(232, 93, 38, .1);
}
.btn-submit {
    width: 100%;
    padding: 12px;
    background: var(--primary);
    color: #fff;
    border: none;
    border-radius: var(--radius-sm);
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    margin-top: 8px;
}
.btn-submit:hover { opacity: .9; }
.error-msg {
    background: #fff3f0;
    border: 1px solid #ffd0c4;
    border-radius: var(--radius-sm);
    padding: 12px 16px;
    color: #c62828;
    font-size: 14px;
    margin-bottom: 16px;
}
.result-card {
    background: var(--bg2);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 28px;
    text-align: center;
}
.result-card h3 { font-size: 18px; font-weight: 700; margin-bottom: 20px; }
.leave-stats {
    display: flex;
    gap: 16px;
    justify-content: center;
    flex-wrap: wrap;
    margin-bottom: 16px;
}
.leave-stat {
    flex: 1;
    min-width: 100px;
    padding: 16px;
    background: var(--bg3);
    border-radius: var(--radius-sm);
}
.leave-stat .val { font-size: 28px; font-weight: 700; color: var(--primary); }
.leave-stat .lbl { font-size: 12px; color: var(--text2); margin-top: 4px; }
.leave-info {
    font-size: 13px;
    color: var(--text2);
    margin-top: 12px;
}
{% endblock %}

{% block public_content %}
<div class="leave-container">
    <h1 class="page-title">연차 조회</h1>
    <p class="page-desc">이름과 생년월일을 입력하여 본인의 연차유급휴가 현황을 확인하세요.</p>

    {% if error %}
    <div class="error-msg">{{ error }}</div>
    {% endif %}

    {% if not employee %}
    <div class="input-card">
        <h3>본인 확인</h3>
        <form method="POST" action="/leave">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
            <div class="form-group">
                <label class="form-label">이름</label>
                <input type="text" name="name" class="form-input" placeholder="홍길동" required>
            </div>
            <div class="form-group">
                <label class="form-label">생년월일 (6자리)</label>
                <input type="text" name="birth_date" class="form-input" placeholder="990101" maxlength="6"
                       pattern="[0-9]{6}" required>
            </div>
            <button type="submit" class="btn-submit">조회</button>
        </form>
    </div>
    {% else %}
    <div class="result-card">
        <h3>{{ employee.name }}님의 {{ year }}년 연차 현황</h3>
        {% if balance %}
        <div class="leave-stats">
            <div class="leave-stat">
                <div class="val">{{ '%.0f'|format(balance.entitled) }}</div>
                <div class="lbl">발생일수</div>
            </div>
            <div class="leave-stat">
                <div class="val">{{ '%.0f'|format(balance.used) }}</div>
                <div class="lbl">사용일수</div>
            </div>
            <div class="leave-stat">
                <div class="val">{{ '%.0f'|format(balance.remaining) }}</div>
                <div class="lbl">잔여일수</div>
            </div>
        </div>
        <div class="leave-info">
            입사일: {{ employee.hire_date.strftime('%Y-%m-%d') if employee.hire_date else '미등록' }}
        </div>
        {% else %}
        <div class="leave-info">
            연차 데이터가 아직 동기화되지 않았습니다.<br>관리자에게 문의해주세요.
        </div>
        {% endif %}
        <div style="margin-top:20px;">
            <a href="/leave" style="color:var(--primary);font-size:14px;">다시 조회하기</a>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}
